angular.module("am.controller",["am.service"]).controller("amController",["amService",function(amService){var vm=this;amService.get().then(function(msg){vm.app_message=msg})}]);angular.module("am.directive",["am.controller"]).directive("applicationMessages",[function(){return{controller:"amController",controllerAs:"amctrl",replace:true,template:'<div ng-if="amctrl.app_message.msg!=\'\'" class="panel ">'+'<div ng-cloak class="panel-heading bg-{{amctrl.app_message.status}}">'+'<span ng-cloak class="glyphicon glyphicon-wrench"></span>'+"{{amctrl.app_message.msg}}"+"</div></div>"}}]);angular.module("application.messages",["am.service","am.directive"]);angular.module("am.service",[]).service("amService",["$q","$http",function($q,$http){return{get:function(){var deferred=$q.defer();$http.get("/status/message").then(function(response){if(window.DOMParser){parser=new DOMParser;xmlDoc=parser.parseFromString(response.data,"text/xml")}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(response.data)}appMessageContainer=xmlDoc.getElementsByTagName("app_message");var status="";var appstatus=appMessageContainer[0].getAttribute("status");switch(appstatus){case"ok":status="ok";break;case"message":status="info";break;case"maintenance":status="warning";break;case"application_error":status="danger";break;default:status=appstatus;break}var appMessage="";if(status!="ok"){appMessage=appMessageContainer[0].getElementsByTagName("status_text")[0].childNodes[0].nodeValue}deferred.resolve({msg:appMessage,status:status})});return deferred.promise}}}]);